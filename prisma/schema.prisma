generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     String                 @id(map: "profiles_pkey") @default(uuid()) @db.Uuid
  fullName               String?                @map("full_name")
  phone                  String?
  role                   Role?                  @default(CUSTOMER)
  wholesaleStatus        WholesaleStatus?       @map("wholesale_status")
  wholesaleTier          WholesaleTier?         @map("wholesale_tier")
  createdAt              DateTime?              @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt              DateTime?              @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  email                  String?                @unique
  password               String?
  isBlocked              Boolean?               @default(false) @map("is_blocked")
  resetToken             String?                @map("reset_token")
  resetTokenExpiry       DateTime?              @map("reset_token_expiry")
  wholesale_applications WholesaleApplication[] @relation("Applicant")
  reviewed_applications  WholesaleApplication[]
  addresses              Address[]
  orders                 Order[]
  repair_tickets         RepairTicket[]

  @@map("users")
}

model WholesaleApplication {
  id              String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  userId          String    @map("user_id") @db.Uuid
  user            User      @relation("Applicant", fields: [userId], references: [id], onDelete: Cascade)
  businessName    String    @map("business_name")
  businessType    String?   @map("business_type")
  taxId           String    @map("tax_id")
  website         String?
  businessPhone   String    @map("business_phone")
  businessEmail   String    @map("business_email")
  businessAddress Json      @map("business_address")
  documents       String[]  @default([])
  status          String?   @default("pending")
  requestedTier   String?   @map("requested_tier")
  approvedTier    String?   @map("approved_tier")
  reviewedBy      String?   @map("reviewed_by") @db.Uuid
  reviewedAt      DateTime? @map("reviewed_at") @db.Timestamptz(6)
  rejectionReason String?   @map("rejection_reason")
  adminNotes      String?   @map("admin_notes")
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  users           User?     @relation(fields: [reviewedBy], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([status], map: "idx_wholesale_applications_status")
  @@index([userId], map: "idx_wholesale_applications_user_id")
  @@map("wholesale_applications")
}

model Category {
  id               String           @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  name             String
  slug             String           @unique
  description      String?
  icon             String?
  displayOrder     Int?             @default(0) @map("display_order")
  isActive         Boolean?         @default(true) @map("is_active")
  createdAt        DateTime?        @default(now()) @map("created_at") @db.Timestamptz(6)
  parentId         String?          @map("parent_id") @db.Uuid
  sort_order       Int?             @default(0)
  show_in_nav      Boolean?         @default(true)
  is_mega_menu     Boolean?         @default(false)
  image_url        String?
  color            String?
  product_count    Int?             @default(0)
  updatedAt        DateTime?        @default(now()) @updatedAt @map("updated_at")
  parent           Category?        @relation("CategoryHierarchy", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children         Category[]       @relation("CategoryHierarchy")
  navigation_items NavigationItem[]
  phoneModels      PhoneModel[]
  product_models   product_models[]
  products         Product[]

  @@index([isActive], map: "idx_categories_is_active")
  @@index([show_in_nav, isActive], map: "idx_categories_nav")
  @@index([parentId, sort_order], map: "idx_categories_parent")
  @@index([parentId], map: "idx_categories_parent_id")
  @@index([slug], map: "idx_categories_slug")
  @@map("categories")
}

model Product {
  id                String           @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  sku               String           @unique
  name              String
  slug              String           @unique
  categoryId        String?          @map("category_id") @db.Uuid
  brand             String
  deviceModel       String?          @map("device_model")
  productType       String?          @map("product_type")
  description       String?
  specifications    Json?
  basePrice         Decimal          @map("base_price") @db.Decimal(10, 2)
  costPrice         Decimal?         @map("cost_price") @db.Decimal(10, 2)
  tier1Discount     Decimal?         @default(8.00) @map("wholesale_tier1_discount") @db.Decimal(5, 2)
  tier2Discount     Decimal?         @default(17.00) @map("wholesale_tier2_discount") @db.Decimal(5, 2)
  tier3Discount     Decimal?         @default(25.00) @map("wholesale_tier3_discount") @db.Decimal(5, 2)
  totalStock        Int?             @default(0) @map("total_stock")
  lowStockThreshold Int?             @default(10) @map("low_stock_threshold")
  images            String[]         @default([])
  thumbnail         String?
  isActive          Boolean?         @default(true) @map("is_active")
  isFeatured        Boolean?         @default(false) @map("is_featured")
  isNew             Boolean?         @default(false) @map("is_new")
  isBestseller      Boolean?         @default(false) @map("is_bestseller")
  metaTitle         String?          @map("meta_title")
  metaDescription   String?          @map("meta_description")
  createdAt         DateTime?        @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt         DateTime?        @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  model_id          String?          @db.Uuid
  brand_id          String?          @db.Uuid
  brandRelation     Brand?           @relation(fields: [brand_id], references: [id], onDelete: SetNull, onUpdate: NoAction)
  cartItems         CartItem[]
  inventory         Inventory[]
  orderItems        OrderItem[]
  variants          ProductVariant[]
  product_models    product_models?  @relation(fields: [model_id], references: [id], onUpdate: NoAction, map: "fk_products_model_id")
  category          Category?        @relation(fields: [categoryId], references: [id], onUpdate: NoAction)
  reviews           Review[]
  stockAlerts       StockAlert[]
  wishlists         Wishlist[]

  @@index([isActive], map: "idx_products_active")
  @@index([basePrice], map: "idx_products_base_price")
  @@index([brand], map: "idx_products_brand")
  @@index([brand_id], map: "idx_products_brand_id")
  @@index([categoryId], map: "idx_products_category")
  @@index([categoryId], map: "idx_products_category_id")
  @@index([deviceModel], map: "idx_products_device_model")
  @@index([isFeatured], map: "idx_products_featured")
  @@index([isActive], map: "idx_products_is_active")
  @@index([isFeatured], map: "idx_products_is_featured")
  @@index([isNew], map: "idx_products_is_new")
  @@index([model_id], map: "idx_products_model")
  @@index([productType], map: "idx_products_product_type")
  @@index([totalStock], map: "idx_products_total_stock")
  @@map("products")
}

model Order {
  id              String               @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  orderNumber     String               @unique @map("order_number")
  userId          String?              @map("user_id") @db.Uuid
  user            User?                @relation(fields: [userId], references: [id], onDelete: SetNull)
  customerName    String               @map("customer_name")
  customerEmail   String               @map("customer_email")
  customerPhone   String?              @map("customer_phone")
  subtotal        Decimal              @db.Decimal(10, 2)
  discountAmount  Decimal?             @default(0) @map("discount_amount") @db.Decimal(10, 2)
  taxAmount       Decimal?             @default(0) @map("tax_amount") @db.Decimal(10, 2)
  shippingCost    Decimal?             @default(0) @map("shipping_cost") @db.Decimal(10, 2)
  totalAmount     Decimal              @map("total_amount") @db.Decimal(10, 2)
  isWholesale     Boolean?             @default(false) @map("is_wholesale")
  wholesaleTier   String?              @map("wholesale_tier")
  shippingAddress Json                 @map("shipping_address")
  billingAddress  Json?                @map("billing_address")
  status          String?              @default("pending")
  paymentStatus   String?              @default("pending") @map("payment_status")
  paymentMethod   String?              @map("payment_method")
  paymentIntentId String?              @unique @map("payment_intent_id")
  trackingNumber  String?              @map("tracking_number")
  carrier         String?
  customerNotes   String?              @map("customer_notes")
  adminNotes      String?              @map("admin_notes")
  shippedAt       DateTime?            @map("shipped_at") @db.Timestamptz(6)
  deliveredAt     DateTime?            @map("delivered_at") @db.Timestamptz(6)
  cancelledAt     DateTime?            @map("cancelled_at") @db.Timestamptz(6)
  createdAt       DateTime?            @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime?            @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  is_guest        Boolean?             @default(false)
  couponUsage     CouponUsage[]
  orderItems      OrderItem[]
  statusHistory   OrderStatusHistory[]
  reviews         Review[]

  @@index([createdAt(sort: Desc)], map: "idx_orders_created_at")
  @@index([customerEmail], map: "idx_orders_customer_email")
  @@index([is_guest], map: "idx_orders_is_guest")
  @@index([orderNumber], map: "idx_orders_order_number")
  @@index([paymentStatus], map: "idx_orders_payment_status")
  @@index([status], map: "idx_orders_status")
  @@index([userId], map: "idx_orders_user")
  @@index([userId, createdAt(sort: Desc)], map: "idx_orders_user_created_at")
  @@index([userId], map: "idx_orders_user_id")
  @@map("orders")
}

model OrderItem {
  id              String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  orderId         String    @map("order_id") @db.Uuid
  productId       String?   @map("product_id") @db.Uuid
  productName     String    @map("product_name")
  productSku      String    @map("product_sku")
  productImage    String?   @map("product_image")
  unitPrice       Decimal   @map("unit_price") @db.Decimal(10, 2)
  discountPercent Decimal?  @default(0) @map("discount_percentage") @db.Decimal(5, 2)
  quantity        Int
  subtotal        Decimal   @db.Decimal(10, 2)
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  order           Order     @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_order_items_order_id")
  product         Product?  @relation(fields: [productId], references: [id], onUpdate: NoAction)

  @@index([orderId], map: "idx_order_items_order")
  @@index([orderId], map: "idx_order_items_order_id")
  @@index([productId], map: "idx_order_items_product")
  @@index([productId], map: "idx_order_items_product_id")
  @@map("order_items")
}

model RepairTicket {
  id                 String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  ticketNumber       String    @unique @map("ticket_number")
  customerId         String?   @map("customer_id") @db.Uuid
  customer           User?     @relation(fields: [customerId], references: [id], onDelete: SetNull)
  customerName       String    @map("customer_name")
  customerEmail      String    @map("customer_email")
  customerPhone      String    @map("customer_phone")
  deviceBrand        String    @map("device_brand")
  deviceModel        String    @map("device_model")
  imeiSerial         String?   @map("imei_serial")
  issueDescription   String    @map("issue_description")
  issueCategory      String?   @map("issue_category")
  assignedStoreId    String?   @map("assigned_store_id") @db.Uuid
  assignedTechnician String?   @map("assigned_technician")
  appointmentDate    DateTime? @map("appointment_date") @db.Timestamptz(6)
  status             String?   @default("submitted")
  priority           String?   @default("normal")
  estimatedCost      Decimal?  @map("estimated_cost") @db.Decimal(10, 2)
  actualCost         Decimal?  @map("actual_cost") @db.Decimal(10, 2)
  partsCost          Decimal?  @map("parts_cost") @db.Decimal(10, 2)
  laborCost          Decimal?  @map("labor_cost") @db.Decimal(10, 2)
  technicianNotes    String?   @map("technician_notes")
  internalNotes      String?   @map("internal_notes")
  customerNotes      String?   @map("customer_notes")
  deviceImages       String[]  @default([]) @map("device_images")
  confirmedAt        DateTime? @map("confirmed_at") @db.Timestamptz(6)
  startedAt          DateTime? @map("started_at") @db.Timestamptz(6)
  completedAt        DateTime? @map("completed_at") @db.Timestamptz(6)
  cancelledAt        DateTime? @map("cancelled_at") @db.Timestamptz(6)
  createdAt          DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt          DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  stores             Store?    @relation(fields: [assignedStoreId], references: [id], onUpdate: NoAction, map: "fk_repair_tickets_store_id")

  @@index([createdAt(sort: Desc)], map: "idx_repair_tickets_created_at")
  @@index([customerId], map: "idx_repair_tickets_customer")
  @@index([customerId, createdAt(sort: Desc)], map: "idx_repair_tickets_customer_created_at")
  @@index([customerId], map: "idx_repair_tickets_customer_id")
  @@index([status], map: "idx_repair_tickets_status")
  @@index([assignedStoreId], map: "idx_repair_tickets_store")
  @@index([ticketNumber], map: "idx_repair_tickets_ticket_number")
  @@map("repair_tickets")
}

model Store {
  id             String         @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  name           String
  address        String
  city           String
  state          String
  zipCode        String         @map("zip_code")
  phone          String?
  email          String?
  operatingHours Json?          @default("{\"friday\": {\"open\": \"09:00\", \"close\": \"19:00\"}, \"monday\": {\"open\": \"09:00\", \"close\": \"19:00\"}, \"sunday\": {\"open\": \"11:00\", \"close\": \"17:00\"}, \"tuesday\": {\"open\": \"09:00\", \"close\": \"19:00\"}, \"saturday\": {\"open\": \"10:00\", \"close\": \"18:00\"}, \"thursday\": {\"open\": \"09:00\", \"close\": \"19:00\"}, \"wednesday\": {\"open\": \"09:00\", \"close\": \"19:00\"}}") @map("operating_hours")
  isActive       Boolean?       @default(true) @map("is_active")
  createdAt      DateTime?      @default(now()) @map("created_at") @db.Timestamptz(6)
  map_url        String?
  inventory      Inventory[]
  repair_tickets RepairTicket[]

  @@map("stores")
}

model Inventory {
  id              String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  productId       String    @map("product_id") @db.Uuid
  storeId         String    @map("store_id") @db.Uuid
  quantity        Int?      @default(0)
  reservedParam   Int?      @default(0) @map("reserved_quantity")
  lastRestockedAt DateTime? @map("last_restocked_at") @db.Timestamptz(6)
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  product         Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_inventory_product_id")
  store           Store     @relation(fields: [storeId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_inventory_store_id")

  @@unique([productId, storeId])
  @@index([productId], map: "idx_inventory_product")
  @@index([productId], map: "idx_inventory_product_id")
  @@index([storeId], map: "idx_inventory_store")
  @@index([storeId], map: "idx_inventory_store_id")
  @@map("inventory")
}

model CartItem {
  id        String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  userId    String?   @map("user_id") @db.Uuid
  sessionId String?   @map("session_id")
  productId String    @map("product_id") @db.Uuid
  quantity  Int       @default(1)
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  product   Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cart_items_product_id")

  @@unique([userId, productId])
  @@unique([sessionId, productId])
  @@index([productId], map: "idx_cart_items_product_id")
  @@index([sessionId], map: "idx_cart_items_session")
  @@index([sessionId], map: "idx_cart_items_session_id")
  @@index([userId], map: "idx_cart_items_user")
  @@index([userId], map: "idx_cart_items_user_id")
  @@map("cart_items")
}

model PhoneModel {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  categoryId  String   @map("category_id") @db.Uuid
  modelName   String   @map("model_name")
  modelSlug   String   @map("model_slug")
  releaseYear Int?     @map("release_year")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  category    Category @relation(fields: [categoryId], references: [id], onUpdate: NoAction, map: "phone_models_category_fk")

  @@unique([categoryId, modelSlug], map: "phone_models_category_model_unique")
  @@map("phone_models")
}

model Coupon {
  id               String        @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  code             String        @unique
  description      String?
  discountType     String        @map("discount_type")
  discountValue    Decimal       @map("discount_value") @db.Decimal(10, 2)
  minPurchase      Decimal?      @default(0) @map("minimum_purchase") @db.Decimal(10, 2)
  maxDiscount      Decimal?      @map("maximum_discount") @db.Decimal(10, 2)
  maxUses          Int?          @map("max_uses")
  maxUsesPerUser   Int?          @default(1) @map("max_uses_per_user")
  timesUsed        Int?          @default(0) @map("times_used")
  appliesTo        String?       @default("all") @map("applies_to")
  productIds       String[]      @default([]) @map("product_ids") @db.Uuid
  categoryIds      String[]      @default([]) @map("category_ids") @db.Uuid
  userRestrictions String?       @default("all") @map("user_restrictions")
  startDate        DateTime?     @default(now()) @map("start_date") @db.Timestamptz(6)
  endDate          DateTime?     @map("end_date") @db.Timestamptz(6)
  isActive         Boolean?      @default(true) @map("is_active")
  createdAt        DateTime?     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime?     @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  usages           CouponUsage[]

  @@index([code], map: "idx_coupons_code")
  @@index([startDate, endDate], map: "idx_coupons_dates")
  @@index([endDate], map: "idx_coupons_end_date")
  @@index([isActive], map: "idx_coupons_is_active")
  @@index([startDate], map: "idx_coupons_start_date")
  @@map("coupons")
}

model ProductVariant {
  id               String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  productId        String    @map("product_id") @db.Uuid
  variant_name     String
  sku              String    @unique
  price_adjustment Decimal?  @default(0) @db.Decimal(10, 2)
  stock            Int?      @default(0)
  isDefault        Boolean?  @default(false) @map("is_default")
  attributes       Json?
  createdAt        DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  product          Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([productId], map: "idx_product_variants_product_id")
  @@index([sku], map: "idx_product_variants_sku")
  @@map("product_variants")
}

model Review {
  id                   String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  productId            String    @map("product_id") @db.Uuid
  userId               String    @map("user_id") @db.Uuid
  order_id             String?   @db.Uuid
  rating               Int
  title                String?
  comment              String?
  images               String[]  @default([])
  is_verified_purchase Boolean?  @default(false)
  is_approved          Boolean?  @default(true)
  createdAt            DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt            DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  orders               Order?    @relation(fields: [order_id], references: [id], onUpdate: NoAction, map: "fk_reviews_order_id")
  product              Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_reviews_product_id")

  @@unique([productId, userId])
  @@index([is_approved], map: "idx_reviews_is_approved")
  @@index([productId, createdAt(sort: Desc)], map: "idx_reviews_product_created_at")
  @@index([productId], map: "idx_reviews_product_id")
  @@index([rating], map: "idx_reviews_rating")
  @@index([userId], map: "idx_reviews_user_id")
  @@map("reviews")
}

model Wishlist {
  id        String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  userId    String    @map("user_id") @db.Uuid
  productId String    @map("product_id") @db.Uuid
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  product   Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([userId, productId])
  @@index([productId], map: "idx_wishlists_product_id")
  @@index([userId], map: "idx_wishlists_user_id")
  @@map("wishlists")
}

model CouponUsage {
  id             String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  couponId       String    @map("coupon_id") @db.Uuid
  userId         String?   @map("user_id") @db.Uuid
  orderId        String?   @map("order_id") @db.Uuid
  discountAmount Decimal   @map("discount_amount") @db.Decimal(10, 2)
  usedAt         DateTime? @default(now()) @map("used_at") @db.Timestamptz(6)
  coupon         Coupon    @relation(fields: [couponId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  order          Order?    @relation(fields: [orderId], references: [id], onUpdate: NoAction)

  @@index([couponId], map: "idx_coupon_usage_coupon_id")
  @@index([orderId], map: "idx_coupon_usage_order_id")
  @@index([userId], map: "idx_coupon_usage_user_id")
  @@map("coupon_usage")
}

model OrderStatusHistory {
  id        String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  orderId   String    @map("order_id") @db.Uuid
  oldStatus String?   @map("old_status")
  newStatus String    @map("new_status")
  changedBy String?   @map("changed_by") @db.Uuid
  notes     String?
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  order     Order     @relation(fields: [orderId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([orderId], map: "idx_order_status_history_order_id")
  @@map("order_status_history")
}

model StockAlert {
  id         String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  productId  String    @map("product_id") @db.Uuid
  userEmail  String    @map("user_email")
  notifiedAt DateTime? @map("notified_at") @db.Timestamptz(6)
  createdAt  DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  product    Product   @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([productId, userEmail])
  @@index([notifiedAt], map: "idx_stock_alerts_notified_at")
  @@index([productId], map: "idx_stock_alerts_product_id")
  @@map("stock_alerts")
}

model NavigationItem {
  id         String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  title      String
  url        String
  parentId   String?          @map("parent_id") @db.Uuid
  type       String?          @default("link")
  categoryId String?          @map("category_id") @db.Uuid
  icon       String?
  sortOrder  Int?             @default(0) @map("sort_order")
  isActive   Boolean?         @default(true) @map("is_active")
  createdAt  DateTime?        @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime?        @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)
  categories Category?        @relation(fields: [categoryId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  parent     NavigationItem?  @relation("NavHierarchy", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  children   NavigationItem[] @relation("NavHierarchy")

  @@index([isActive, sortOrder], map: "idx_navigation_items_active")
  @@index([parentId, sortOrder], map: "idx_navigation_items_parent")
  @@map("navigation_items")
}

model HomepageSettings {
  id                  String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  heroAutoplay        Boolean?  @default(true) @map("hero_autoplay")
  heroInterval        Int?      @default(5000) @map("hero_interval")
  flashDealsTitle     String?   @default("Flash Deals") @map("flash_deals_title")
  flashDealsSubtitle  String?   @default("Limited time offers") @map("flash_deals_subtitle")
  newArrivalsTitle    String?   @default("New Arrivals") @map("new_arrivals_title")
  newArrivalsSubtitle String?   @default("Just landed") @map("new_arrivals_subtitle")
  createdAt           DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt           DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("homepage_settings")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model homepage_banners {
  id          String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  title       String
  subtitle    String?
  image_url   String
  link_url    String?
  button_text String?   @default("Shop Now")
  text_color  String?   @default("#FFFFFF")
  is_active   Boolean?  @default(true)
  sort_order  Int?      @default(0)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model product_models {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  category_id   String?   @db.Uuid
  name          String
  slug          String    @unique
  sort_order    Int?      @default(0)
  is_new        Boolean?  @default(false)
  is_active     Boolean?  @default(true)
  product_count Int?      @default(0)
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
  updated_at    DateTime? @default(now()) @db.Timestamptz(6)
  brand_id      String?   @db.Uuid
  categories    Category? @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  products      Product[]
  brand         Brand?    @relation(fields: [brand_id], references: [id], onDelete: SetNull, onUpdate: NoAction)

  @@index([category_id, sort_order], map: "idx_product_models_category")
  @@index([brand_id], map: "idx_product_models_brand_id")
}

enum Role {
  CUSTOMER  @map("customer")
  ADMIN     @map("admin")
  WHOLESALE @map("wholesale")
}

enum WholesaleStatus {
  PENDING  @map("pending")
  APPROVED @map("approved")
  REJECTED @map("rejected")
}

enum WholesaleTier {
  TIER1 @map("tier1")
  TIER2 @map("tier2")
  TIER3 @map("tier3")
}

model SystemSetting {
  id        String   @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  key       String   @unique
  value     Json
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("system_settings")
}

model HeroSlide {
  id           String   @id @default(uuid())
  badge        String?
  badgeColor   String?  @map("badge_color")
  title        String
  description  String?
  ctaPrimary   Json?    @map("cta_primary")
  ctaSecondary Json?    @map("cta_secondary")
  image        String
  gradient     String?
  trustBadges  Json?    @map("trust_badges")
  discount     String?
  sortOrder    Int      @default(0) @map("sort_order")
  isActive     Boolean  @default(true) @map("is_active")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("hero_slides")
}

enum AddressType {
  SHIPPING
  BILLING
}

model Address {
  id        String      @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  userId    String      @map("user_id") @db.Uuid
  fullName  String      @map("full_name")
  company   String?
  street1   String
  street2   String?
  city      String
  state     String
  zipCode   String      @map("zip_code")
  country   String      @default("US")
  phone     String?
  type      AddressType @default(SHIPPING)
  isDefault Boolean     @default(false) @map("is_default")
  createdAt DateTime    @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime    @updatedAt @map("updated_at") @db.Timestamptz(6)
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("addresses")
}

model Subscriber {
  id             String    @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  email          String    @unique
  isSubscribed   Boolean   @default(true) @map("is_subscribed")
  unsubscribedAt DateTime? @map("unsubscribed_at") @db.Timestamptz(6)
  createdAt      DateTime? @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime? @default(now()) @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("subscribers")
}

model Brand {
  id        String  @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  name      String  @unique
  slug      String  @unique
  logo      String?
  type      String  @default("phone") // phone, tablet, laptop
  isPopular Boolean @default(false) @map("is_popular")
  isActive  Boolean @default(true) @map("is_active")
  sortOrder Int     @default(0) @map("sort_order")

  // Relations
  products Product[]
  models   product_models[]

  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("brands")
}

model Page {
  id              String   @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  title           String
  slug            String   @unique
  content         String   @db.Text
  metaTitle       String?  @map("meta_title")
  metaDescription String?  @map("meta_description")
  isPublished     Boolean  @default(false) @map("is_published")
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("pages")
}

model StoreLocation {
  id        String   @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  name      String
  address   String
  city      String
  state     String
  zip       String
  phone     String?
  email     String?
  hours     String?
  latitude  Float?
  longitude Float?
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("store_locations")
}

model SiteSetting {
  key       String   @id
  value     String   @db.Text
  group     String   @default("general")
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("site_settings")
}

model NewsletterSubscriber {
  id        String   @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  email     String   @unique
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)

  @@map("newsletter_subscribers")
}

model HomepageSection {
  id        String   @id @default(dbgenerated("extensions.uuid_generate_v4()")) @db.Uuid
  sectionId String   @unique @map("section_id") // e.g., 'flash_deals', 'top_brands'
  name      String
  isActive  Boolean  @default(true) @map("is_active")
  sortOrder Int      @default(0) @map("sort_order")
  config    Json? // Use for extra settings like countdownTimer endDate
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("homepage_sections")
}
